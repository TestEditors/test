<html>
<style>
img {
    max-width: 100%;
    max-height: 140vh;
    height: auto;
}
body, html {
  margin: 0;
  overflow: hidden;
  height:100%;
}

@media (min-width: 768px){
  #left {
    position: absolute;
    top: 0px;
    bottom: 0;
    left: 0;
    width: 50%;
    overflow-y: scroll; 
  }
  
  #right {
    position: absolute;
    top: 0;
    bottom: 0;
    right: 0;
    overflow-y: scroll;
    width: 50%;
  }
}

#left {
  height:100%;
}

#right {
  height:100%;
}
</style>
<script src="tinymce/js/tinymce/tinymce.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/js/bootstrap.min.js"></script>
<script src='https://code.responsivevoice.org/responsivevoice.js'></script>
<script src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js'></script>
<script src='https://cdnjs.cloudflare.com/ajax/libs/oauth-io/0.6.2/oauth.min.js'></script>
<script src="https://code.jquery.com/jquery-3.3.1.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<link rel="stylesheet" type="text/css" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css">
<body>
    <div class="row">
    <div class="col-md-6" style="heigh:100%" id='left'>
        <label>Page </label>
        <input type="number" id="page" min="1" max="176" step="1" value="1">
        <label> Changing the page will reset edits!</label>
        <br/>
        <input onclick='responsiveVoice.speak(tinyMCE.activeEditor.getContent({ format: "text" }));' type='button' value='Read out loud' />
        <textarea class='my-mce-container' id='ocr-text'>
        </textarea>
    </div>
    <div class="col-md-6" id='right'>
        <img id='book-image' alt="Image of book page">
    </div>
    </div>
</body>
<script>
/*
    OAuth.initialize('VnRodo6ycABEgsuWx0LF7BBgO-I');
    var provider = 'github';

    OAuth.popup(provider)
    .done(function(result) {
        result.me()
        .done(function (response) {
            console.log(response);
        })
        .fail(function (err) {
            console.error(err);
        });
    })
    .fail(function (err) {
        console.error(err);
    });
*/

    function newPage() {
        var activeEditor = tinyMCE.get('ocr-text');
        console.log(123);
        console.log(activeEditor);
        var content = 'HTML or plain text content here...';
        var xhr= new XMLHttpRequest();
        var page = $('#page').val();
        xhr.open('GET', 'htmls/' + page + '.html', true);
        xhr.onreadystatechange= function() {
            if (this.readyState!==4) return;
            if (this.status!==200) return; // or whatever error handling you want
            //document.getElementById('ocr-text').innerHTML= this.responseText;
            activeEditor.setContent(this.responseText);
        };
        xhr.send();
        document.getElementById('book-image').src = ('pngs/' + page + '.png');
    }

    tinymce.init({ 
        selector:'textarea', 
        plugins: "autoresize",
        init_instance_callback: function() {
            $('#page').change(newPage);
            newPage();
        }
    });
</script>
</html>
